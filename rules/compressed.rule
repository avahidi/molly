
rule LZMANew {
    var header = StringZ(0, 5);
    var type = Byte(6) & 0x10;

    if header == { 0xFF, 'L', 'Z', 'M', 'A'};
}

rule LZMA51 {
    var header = String(0, 3);
    if header == { 0x51, 0x00, 0x00 };
}

rule LZMA5d {
    var header = String(0, 3);

    if header == { 0x5D, 0x00, 0x00 };
}